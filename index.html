<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BROKEN HEART Project - Gaza Casualties</title>
    <style>
        @font-face {
            font-family: 'Akzidenz Grotesk';
            src: url('AkzidenzGrotesk-Super.ttf') format('truetype');
            font-weight: 900;
        }

        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: white;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
            overflow: hidden;
        }

        /* ===== 공통 스타일 ===== */
        .page {
            width: 100%;
            height: 100vh;
            display: none;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .page.active {
            display: flex;
        }

        /* ===== PAGE 1: BROKEN HEART ===== */
        #page1 {
            background-color: white;
            flex-direction: column;
        }

        .page1-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            background-color: black;
        }

        .page1-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            background-color: white;
        }

        /* ===== PAGE 2: 통계 ===== */
        #page2 {
            background-color: white;
            flex-direction: column;
        }

        .page2-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .background-typo {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.08;
            animation: fadeInBg 1.5s ease-in-out 5.5s forwards;
            object-fit: cover;
            z-index: 1;
        }

        .page2-content {
            position: relative;
            z-index: 2;
            padding: 60px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 100%;
        }

        .top-section {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 5.5s forwards;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
        }

        .title {
            font-size: 32px;
            font-weight: 900;
            margin-top: 0px;
            margin-bottom: 30px;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 6s forwards;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
        }

        .main-number {
            font-size: 180px;
            font-weight: 900;
            color: black;
            line-height: 1;
            letter-spacing: -5px;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 6.5s forwards;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
        }

        .stats-section {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 60px 100px;
            margin-top: 80px;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 7s forwards;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
        }

        .stat-item:first-child .stat-number {
            color: #FF0000;
        }

        .stat-number {
            font-size: 48px;
            font-weight: 900;
            margin-bottom: 20px;
            color: black;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
        }

        .stat-label {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 2px;
            color: black;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
        }

        .stat-item:first-child .stat-label {
            color: #FF0000;
        }

        .bottom-section {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding-top: -20px;
            padding-bottom: -40px;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 7.5s forwards;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
        }

        .bottom-text {
            font-size: 14px;
            color: black;
        }

        .rabbit1-container {
            position: relative;
            width: 150px;
            height: 150px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .rabbit1-container:hover {
            transform: scale(4);
        }

        .rabbit1-image {
            width: 105%;
            height: 105%;
            object-fit: contain;
        }

        /* ===== PAGE 3: 상세 정보 ===== */
        #page3 {
            background-color: white;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .page3-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .rabbit2-container {
            position: absolute;
            bottom: -500px;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 100%;
            animation: rabbitRiseUp 2s ease-out 0.5s forwards;
            z-index: 1;
        }

        .rabbit2-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .page3-content {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 40px;
        }

        .page3-title {
            font-size: 64px;
            font-weight: 900;
            margin-bottom: 30px;
            animation: fadeIn 1s ease-in-out 2.5s forwards;
            opacity: 0;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
        }

        .page3-text {
            font-size: 24px;
            line-height: 1.8;
            margin-bottom: -80px;
            animation: fadeIn 1s ease-in-out 3s forwards;
            opacity: 0;
            font-family: 'Akzidenz Grotesk', 'Poppins', Arial, sans-serif;
        }

        .qr-code-container {
            position: absolute;
            bottom: -300px;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 200px;
            animation: qrRiseUp 2s ease-out 2.5s forwards;
            z-index: 3;
        }

        .qr-code-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* ===== 애니메이션 ===== */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeInBg {
            from {
                opacity: 0;
            }
            to {
                opacity: 0.15;
            }
        }

        @keyframes typeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        @keyframes rabbitRiseUp {
            from {
                bottom: -200px;
                opacity: 0;
            }
            to {
                bottom: 0;
                opacity: 1;
            }
        }

        /* ===== 모바일 반응형 ===== */
        @media (max-width: 768px) {
            .typo-image {
                width: 90%;
            }

            .text-overlay {
                font-size: 60px;
                letter-spacing: 4px;
            }

            .page2-content {
                padding: 30px;
            }

            .title {
                font-size: 20px;
            }

            .main-number {
                font-size: 80px;
            }

            .stats-section {
                grid-template-columns: 1fr;
                gap: 30px;
            }

            .stat-number {
                font-size: 32px;
            }

            .stat-label {
                font-size: 12px;
            }

            .rabbit1-container {
                width: 100px;
                height: 100px;
            }

            .page3-title {
                font-size: 40px;
            }

            .page3-text {
                font-size: 14px;
            }

            .rabbit2-container {
                width: 250px;
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- ===== PAGE 1: BROKEN HEART (영상) ===== -->
    <div class="page active" id="page1">
        <div class="page1-container">
            <video class="page1-video" autoplay muted loop playsinline>
                <source src="page1-animation.mp4" type="video/mp4">
                <source src="page1-animation.webm" type="video/webm">
                Your browser does not support the video tag.
            </video>
        </div>
    </div>

    <!-- ===== PAGE 2: 통계 ===== -->
    <div class="page" id="page2">
        <div class="page2-container">
            <img src="typo-no-text.png" alt="Background" class="background-typo">
            
            <div class="page2-content">
                <!-- 상단 텍스트 -->
                <div class="top-section">
                    <p class="top-left">Guarantee - Your windows will remain safe forever</p>
                    <p class="top-right">BROKEN HEART Project</p>
                </div>

                <!-- 메인 콘텐츠 -->
                <div class="main-content">
                    <h1 class="title">Gaza casualties — live death toll</h1>
                    <div class="main-number" id="mainNumber">0</div>
                    
                    <!-- 통계 -->
                    <div class="stats-section">
                        <div class="stat-item">
                            <div class="stat-number" id="childrenKilled">0</div>
                            <p class="stat-label">CHILDREN KILLED</p>
                        </div>
                        
                        <div class="stat-item">
                            <div class="stat-number" id="womenKilled">0</div>
                            <p class="stat-label">WOMEN KILLED</p>
                        </div>
                        
                        <div class="stat-item">
                            <div class="stat-number" id="pressKilled">0</div>
                            <p class="stat-label">PRESS KILLED</p>
                        </div>
                        
                        <div class="stat-item">
                            <div class="stat-number" id="medicalKilled">0</div>
                            <p class="stat-label">MEDICAL KILLED</p>
                        </div>
                        
                        <div class="stat-item">
                            <div class="stat-number" id="injured">0</div>
                            <p class="stat-label">INJURED (TOTAL)</p>
                        </div>
                        
                        <div class="stat-item">
                            <div class="stat-number" id="starved">0</div>
                            <p class="stat-label">STARVED (TOTAL)</p>
                        </div>
                    </div>
                </div>

                <!-- 하단 섹션 -->
                <div class="bottom-section">
                    <p class="bottom-text">CLICK and GET QR CODE</p>
                    <div class="rabbit1-container" id="rabbit1Trigger">
                        <img src="rabbit1.png" alt="Click to continue" class="rabbit1-image">
                    </div>
                    <p class="bottom-text">Genocide on your Phone</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== PAGE 3: 상세 정보 ===== -->
    <div class="page" id="page3">
        <div class="page3-container">
            <div class="rabbit2-container">
                <img src="rabbit2.png" alt="Rabbit" class="rabbit2-image">
            </div>
            
            <div class="page3-content">
                <p class="page3-text">Click anywhere to return</p>
            </div>
            
            <div class="qr-code-container">
                <img src="qr.png" alt="QR Code" class="qr-code-image">
            </div>
        </div>
    </div>

    <script>
        // ===== 페이지 관리 =====
        let currentPage = 1;

        function changePage(pageNum) {
            document.getElementById(`page${currentPage}`).classList.remove('active');
            document.getElementById(`page${pageNum}`).classList.add('active');
            currentPage = pageNum;

            // 페이지 2에 도착하면 API 데이터 로드
            if (pageNum === 2) {
                loadAndAnimateData();
            }
        }

        // ===== 페이지 1 → 2 자동 전환 (영상 끝난 후) =====
        // 영상이 끝나면 자동으로 페이지 2로 전환
        document.getElementById('page1').querySelector('video').addEventListener('ended', () => {
            changePage(2);
        });

        // ===== 페이지 1 클릭/터치 시 즉시 페이지 2로 =====
        document.getElementById('page1').addEventListener('click', () => {
            changePage(2);
        });

        document.getElementById('page1').addEventListener('keydown', () => {
            changePage(2);
        });

        // ===== 토끼1 클릭 → 페이지 3 =====
        document.getElementById('rabbit1Trigger').addEventListener('click', () => {
            changePage(3);
        });

        // ===== 페이지 3 클릭 → 페이지 1 (순환) =====
        document.getElementById('page3').addEventListener('click', () => {
            changePage(1);
            // 영상 재시작
            const video = document.getElementById('page1').querySelector('video');
            video.currentTime = 0;
            video.play();
        });

        // ===== API 데이터 로드 및 애니메이션 =====
        const defaultData = {
            mainNumber: 68277,
            childrenKilled: 20179,
            womenKilled: 12500,
            pressKilled: 255,
            medicalKilled: 1701,
            injured: 170361,
            starved: 463
        };

        async function fetchCasualtyData() {
            try {
                // Palestine Datasets API
                const response = await fetch('https://data.techforpalestine.org/api/v1/casualties');
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('Palestine Datasets API 데이터 로드 성공:', data);
                    
                    const latestData = data[data.length - 1];
                    
                    return {
                        mainNumber: latestData.killed_total || defaultData.mainNumber,
                        childrenKilled: latestData.children_killed || defaultData.childrenKilled,
                        womenKilled: latestData.women_killed || defaultData.womenKilled,
                        pressKilled: latestData.press_killed || defaultData.pressKilled,
                        medicalKilled: latestData.medical_killed || defaultData.medicalKilled,
                        injured: latestData.injured_total || defaultData.injured,
                        starved: latestData.starved_total || defaultData.starved
                    };
                }
                
                console.log('API 응답 오류, 기본값 사용');
                return defaultData;
                
            } catch (error) {
                console.error('API 로드 실패:', error);
                console.log('기본값 사용');
                return defaultData;
            }
        }

        function animateNumber(element, targetNumber, duration = 2000, delay = 0) {
            setTimeout(() => {
                let currentNumber = 0;
                const startTime = Date.now();
                
                function update() {
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    currentNumber = Math.floor(targetNumber * progress);
                    element.textContent = currentNumber.toLocaleString('en-US');
                    
                    if (progress < 1) {
                        requestAnimationFrame(update);
                    } else {
                        element.textContent = targetNumber.toLocaleString('en-US');
                    }
                }
                
                requestAnimationFrame(update);
            }, delay);
        }

        function animateAllNumbers(data) {
            // 메인 숫자 (2초) - 즉시 시작
            animateNumber(document.getElementById('mainNumber'), data.mainNumber, 2000, 0);
            
            // 개별 숫자들 (스태거 효과 - 차례대로)
            animateNumber(document.getElementById('childrenKilled'), data.childrenKilled, 1500, 300);
            animateNumber(document.getElementById('womenKilled'), data.womenKilled, 1500, 600);
            animateNumber(document.getElementById('pressKilled'), data.pressKilled, 1500, 900);
            animateNumber(document.getElementById('medicalKilled'), data.medicalKilled, 1500, 1200);
            animateNumber(document.getElementById('injured'), data.injured, 1500, 1500);
            animateNumber(document.getElementById('starved'), data.starved, 1500, 1800);
        }

        async function loadAndAnimateData() {
            const data = await fetchCasualtyData();
            animateAllNumbers(data);
        }
    </script>
</body>
</html>